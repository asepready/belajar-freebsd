# DNS Server FreeBSD
<p align="center">
<img src="./../assets/images/logo.png" alt="Logo" style="width:200px;"/>
</p>

## Persiapan Hosts
| Komponen | Deskripsi |
| - | - |
| Hostname | lab-fbsd |
| Interface | em0 |
| Host IP address | 172.16.16.99/24 |
| IP address range | 172.16.16.100 â€“ 172.16.16.254 |
| Internet gateway | 172.16.16.1 |
| Domain Local | lab-fbsd.edu |
| DNS server/s | 172.16.16.99, 8.8.8.8 |

## Persiapan DNS Server
| Komponen | Deskripsi | - |
| - | - | - |
| Domain Name | lab-fbsd.edu |
| Ricord ==> | A | www, mail, ftp, ns1 |
|        ==> | NS | ns1.lab-fbsd.edu |
|        ==> | MX | (10) mail.lab-fbsd.edu |
|        ==> | CNAME | home mapped to www.lab-fbsd.edu |
## Install Paket yang di butuhkan
```sh
pkg ins bind918
```
## Lakukan Konfigurasi
```sh term
#/etc/rc.conf
hostname="lab-fbsd"
ifconfig_em0="inet 172.16.16.99 netmask 255.255.255.0"
defaultrouter="172.16.16.1"
sshd_enable=YES
sendmail_enable=NONE
clear_tmp_enable=YES
syslogd_flags="-ss"
dumpdev=NO
```
## Mengkonfigurasi Server DNS
Periksa dan Cadangkan konfigurasi default setelah server DHCP diinstal
```sh file
cat /usr/local/etc/namedb/named.conf
cp /usr/local/etc/namedb/named.conf /usr/local/etc/namedb/named.conf.old
```
1. Ubah pada baris listen-on dan forwarders 127.0.0.1
```sh file
// the proper IP address, or delete this option.
        listen-on       { 127.0.0.1; };
```
    menjadi 
```sh file
// the proper IP address, or delete this option.
        listen-on {
                172.16.16.99;
        };
```
```sh file
// benefit from its cache, thus reduce overall DNS traffic in the Internet.
/*
        forwarders {
                127.0.0.1;
        };
*/
```
    menjadi
```sh file
// benefit from its cache, thus reduce overall DNS traffic in the Internet.

        forwarders {
                172.16.16.99;
        };

```
2. Buat zone forward dan zone reverse dibawah localhost
```sh file
// RFCs 1912, 5735 and 6303 (and BCP 32 for localhost)
zone "localhost"        { type primary; file "/usr/local/etc/namedb/primary/localhost-forward.db"; 
zone "127.in-addr.arpa" { type primary; file "/usr/local/etc/namedb/primary/localhost-reverse.db";
```
menjadi
```sh file
zone "localhost"        { type primary; file "/usr/local/etc/namedb/primary/localhost-forward.db"; };
zone "lab-fbsd.edu"        { type primary; file "/usr/local/etc/namedb/primary/lab-fbsd-forward.db"; };
zone "127.in-addr.arpa" { type primary; file "/usr/local/etc/namedb/primary/localhost-reverse.db"; };
zone "16.16.172.in-addr.arpa" { type primary; file "/usr/local/etc/namedb/primary/lab-fbsd-reverse.db"; };
```
2. Buat file di /usr/local/etc/namedb/primary/ dengan lab-fbsd-forward.db dan lab-fbsd-reverse.db
```sh file 
#/usr/local/etc/namedb/primary/lab-fbsd-forward.db
$TTL 604800
@       IN      SOA     lab-fbsd.edu. root.lab-fbsd.edu. (
                        2          ; serial
                        604800     ; refresh
                        7200       ; retry
                        604800     ; expire
                        300 )      ; minimum
; name server
@       IN      NS      ns1.lab-fbsd.edu.
; mail server
        IN      MX      10      mail.lab-fbsd.edu.
; A Record
@       IN      A       172.16.16.99
ns1     IN      A       172.16.16.99
www     IN      A       172.16.16.11
mail    IN      A       172.16.16.12
ftp     IN      A       172.16.16.15
; CNAME Record
ftp     IN      CNAME   ftp.lab-fbsd.edu.
home    IN      CNAME   www.lab-fbsd.edu.
```
dan
```sh file
$TTL 604800
@       IN      SOA     lab-fbsd.edu. root.lab-fbsd.edu. (
                        2          ; serial
                        604800     ; refresh
                        7200       ; retry
                        604800     ; expire
                        300 )      ; minimum
@       IN      NS      ns1.lab-fbsd.edu.
99      IN      PTR     ns1.lab-fbsd.edu.
99      IN      PTR     lab-fbsd.edu.
11      IN      PTR     www.lab-fbsd.edu.
12      IN      PTR     mail.lab-fbsd.edu.
15      IN      PTR     ftp.lab-fbsd.edu.
```
3. edit file hosts dan resolv
```sh file
#/etc/hosts
::1                     localhost localhost.local
127.0.0.1               localhost localhost.local
::1                     lab-fbsd lab-fbsd.edu
172.16.16.99            lab-fbsd lab-fbsd.edu
```
```sh file
#/etc/resolv.conf
# Generated by resolvconf
search lab-fbsd.edu www.lab-fbsd.edu mail.lab-fbsd.edu ftp.lab-fbsd.edu
domain lab-fbsd.edu www.lab-fbsd.edu mail.lab-fbsd.edu ftp.lab-fbsd.edu
nameserver 172.16.16.99 10.10.10.2 8.8.8.8
```
Aktifkan & jalankan layanan DNS server
``` sh file
sysrc named_enable="YES" #aktifkan
service named start
service named status
```


